# typed: false
# frozen_string_literal: true

# This file was generated by GoReleaser. DO NOT EDIT.
class SyncTools < Formula
  desc "Go CLI wrapper around rsync with advanced filtering and SyncFile post-sync actions"
  homepage "https://github.com/DamianReeves/sync-tools"
  version "0.4.1"
  license "Apache-2.0"

  depends_on "rsync" => :runtime

  on_macos do
    if Hardware::CPU.intel?
      url "https://github.com/DamianReeves/sync-tools/releases/download/v0.4.1/sync-tools_0.4.1_darwin_amd64.tar.gz"
      sha256 "8a0c443cc624dd798b66bf011f1325f39c1b9c695b71255998bd816b88c4e986"

      def install
        bin.install "sync-tools"

        # Generate and install shell completions if available
        if File.exist?(buildpath/"completions")
          bash_completion.install "completions/sync-tools.bash" => "sync-tools"
          zsh_completion.install "completions/_sync-tools"
          fish_completion.install "completions/sync-tools.fish"
        end
      end
    end
    if Hardware::CPU.arm?
      url "https://github.com/DamianReeves/sync-tools/releases/download/v0.4.1/sync-tools_0.4.1_darwin_arm64.tar.gz"
      sha256 "1600059316c6234f19c24a0bd923ff0b92ef139dbd901b17bd0aeedd72911d21"

      def install
        bin.install "sync-tools"

        # Generate and install shell completions if available
        if File.exist?(buildpath/"completions")
          bash_completion.install "completions/sync-tools.bash" => "sync-tools"
          zsh_completion.install "completions/_sync-tools"
          fish_completion.install "completions/sync-tools.fish"
        end
      end
    end
  end

  on_linux do
    if Hardware::CPU.intel? and Hardware::CPU.is_64_bit?
      url "https://github.com/DamianReeves/sync-tools/releases/download/v0.4.1/sync-tools_0.4.1_linux_amd64.tar.gz"
      sha256 "bf84f1900c46e0a28c3a5371bbcdc7c3f552a17323cc4be4b34be9c7f3aeec21"
      def install
        bin.install "sync-tools"

        # Generate and install shell completions if available
        if File.exist?(buildpath/"completions")
          bash_completion.install "completions/sync-tools.bash" => "sync-tools"
          zsh_completion.install "completions/_sync-tools"
          fish_completion.install "completions/sync-tools.fish"
        end
      end
    end
    if Hardware::CPU.arm? and Hardware::CPU.is_64_bit?
      url "https://github.com/DamianReeves/sync-tools/releases/download/v0.4.1/sync-tools_0.4.1_linux_arm64.tar.gz"
      sha256 "e31bf516fae4b799d558452ccecdd03c1d58fb3f9ce8009c20ca11302d9fc0a8"
      def install
        bin.install "sync-tools"

        # Generate and install shell completions if available
        if File.exist?(buildpath/"completions")
          bash_completion.install "completions/sync-tools.bash" => "sync-tools"
          zsh_completion.install "completions/_sync-tools"
          fish_completion.install "completions/sync-tools.fish"
        end
      end
    end
  end

  test do
    assert_match version.to_s, shell_output("#{bin}/sync-tools --version 2>&1")

    # Test basic help functionality
    assert_match "Advanced directory synchronization", shell_output("#{bin}/sync-tools --help")

    # Test subcommands exist
    assert_match "sync", shell_output("#{bin}/sync-tools --help")
    assert_match "syncfile", shell_output("#{bin}/sync-tools --help")
  end
end
